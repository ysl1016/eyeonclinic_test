
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>공지사항 | EYEON Clinic</title>
        
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=Manrope:wght@400;700&display=swap" rel="stylesheet">
        
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    
    <!-- SimpleMDE Markdown Editor -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
    <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
    <!-- Marked.js to render Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/dist/output.css">
    <link rel="stylesheet" href="assets/css/main.css">

    <style>
        /* Markdown Editor 스타일 */
        .editor-toolbar, .CodeMirror { border-radius: 0.5rem; border-color: #d1d5db; }
        .CodeMirror-scroll { min-height: 250px; }

        /* --- START: 게시물 콘텐츠 스타일링 --- */
        .post-content h1, .post-content h2, .post-content h3, .post-content h4 {
            color: var(--deep-navy);
            font-weight: 700;
            margin-bottom: 1rem;
            margin-top: 2rem;
        }
        .post-content h1 { font-size: 1.875rem; line-height: 2.25rem; }
        .post-content h2 { font-size: 1.5rem; line-height: 2rem; }
        .post-content h3 { font-size: 1.25rem; line-height: 1.75rem; }
        .post-content p {
            line-height: 1.75;
            margin-bottom: 1.25rem;
            color: #374151;
        }
        .post-content ul, .post-content ol {
            padding-left: 1.5rem;
            margin-bottom: 1.25rem;
            color: #374151;
        }
        .post-content ul { list-style-type: disc; }
        .post-content ol { list-style-type: decimal; }
        .post-content li { margin-bottom: 0.5rem; }
        .post-content a {
            color: var(--emerald-teal);
            text-decoration: underline;
            font-weight: 500;
        }
        .post-content blockquote {
            border-left: 4px solid #d1d5db;
            padding-left: 1rem;
            margin-left: 0;
            font-style: italic;
            color: #6b7280;
        }
        .post-content pre {
            background-color: #f3f4f6;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .post-content code {
            font-family: monospace;
            background-color: #e5e7eb;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
        }
        .post-content pre code { background-color: transparent; padding: 0; }
        .post-content img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
            margin-top: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .post-content hr {
            border-top: 1px solid #e5e7eb;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
        .post-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.25rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .post-content th, .post-content td {
            border: 1px solid #d1d5db;
            padding: 0.75rem 1rem;
            text-align: left;
        }
        .post-content th {
            background-color: #f9fafb;
            font-weight: 600;
        }
        /* --- END: 게시물 콘텐츠 스타일링 --- */

        /* 모달 스타일 */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* 로딩 스피너 */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--emerald-teal);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 40px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header Placeholder -->
    <div id="header-placeholder"></div>

    <main>
        <!-- Hero Section -->
        <section class="relative h-[50vh] md:h-[60vh] flex items-center justify-center text-center text-white overflow-hidden">
            <div class="absolute inset-0">
                <img src="https://images.unsplash.com/photo-1457369804613-52c61a468e7d?q=80&w=2940&auto=format&fit=crop" 
                     alt="책들이 있는 서재 이미지" 
                     class="w-full h-full object-cover"
                     onerror="this.onerror=null;this.src='https://placehold.co/1920x1080/0A2342/ffffff?text=Notice';">
                <div class="absolute inset-0 bg-black/50"></div>
            </div>
            <div class="relative z-10 px-6">
                <h1 class="text-4xl md:text-6xl font-bold tracking-tighter leading-tight text-white">
                    공지사항
                </h1>
                <p class="mt-4 max-w-2xl mx-auto text-lg md:text-xl text-gray-300">
                    이연의원의 새로운 소식과 중요한 정보를 안내해 드립니다.
                </p>
            </div>
        </section>

        <!-- Notice Content Area -->
        <section class="py-20 md:py-28">
            <div id="notice-container" class="max-w-5xl mx-auto px-6">
                <!-- JavaScript에 의해 동적으로 채워질 영역 -->
                <div class="loader"></div>
            </div>
        </section>
    </main>
    
    <!-- Modals -->
    <div id="write-modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title" class="text-2xl font-bold text-deep-navy mb-4">새 글 작성</h3>
            <div class="space-y-4">
                <input type="text" id="post-title" placeholder="제목을 입력하세요" class="w-full p-3 border rounded-md text-lg">
                <div id="editor-container">
                    <textarea id="post-content"></textarea>
                </div>
                <input type="file" id="image-upload-input" class="hidden" accept="image/*">

                <div class="flex justify-end space-x-2">
                    <button id="cancel-post" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300">취소</button>
                    <button id="save-post" class="px-4 py-2 bg-emerald-teal text-white rounded-md hover:opacity-90">저장</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="login-modal" class="modal">
        <div class="modal-content max-w-sm">
            <h4 class="font-bold text-xl mb-4">관리자 로그인</h4>
            <div class="space-y-3">
                <input type="email" id="login-email" placeholder="이메일" class="w-full p-2 border rounded-md">
                <input type="password" id="login-password" placeholder="비밀번호" class="w-full p-2 border rounded-md">
                <p id="login-error" class="text-red-500 text-sm h-4"></p>
            </div>
            <div class="flex justify-end mt-4">
                 <button id="cancel-login" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 mr-2">취소</button>
                <button id="submit-login" class="px-4 py-2 bg-emerald-teal text-white rounded-md hover:opacity-90">로그인</button>
            </div>
        </div>
    </div>

    <!-- Upload Progress Modal -->
    <div id="upload-progress-modal" class="modal">
        <div class="modal-content max-w-sm">
            <h4 class="font-bold text-xl mb-4">이미지 업로드 중</h4>
            <div class="w-full bg-gray-200 rounded-full h-4">
                <div id="progress-bar" class="bg-emerald-teal h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <p id="progress-text" class="text-center mt-2 text-sm font-semibold">0%</p>
            <div class="text-center mt-4">
                <button id="cancel-upload-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm">업로드 취소</button>
            </div>
        </div>
    </div>
    
    <!-- Hyperlink Modal -->
    <div id="hyperlink-modal" class="modal">
        <div class="modal-content max-w-sm">
            <h4 class="font-bold text-xl mb-4">하이퍼링크 추가</h4>
            <div class="space-y-3">
                <input type="text" id="hyperlink-url" placeholder="https://example.com" class="w-full p-2 border rounded-md">
            </div>
            <div class="flex justify-end mt-4">
                 <button id="cancel-hyperlink" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 mr-2">취소</button>
                <button id="submit-hyperlink" class="px-4 py-2 bg-emerald-teal text-white rounded-md hover:opacity-90">확인</button>
            </div>
        </div>
    </div>

    <!-- Floating Action Buttons Placeholder -->
    <div id="floating-buttons-placeholder"></div>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Firebase SDK & App Logic -->
    <script type="module">
        // Firebase SDK 로드
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";
        import { getFirestore, collection, doc, getDoc, getDocs, addDoc, updateDoc, deleteDoc, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";
        import { getStorage, ref, uploadBytesResumable, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-storage.js";

        // 사용자 제공 Firebase 구성 정보
        const firebaseConfig = {
            apiKey: "AIzaSyCGRF48VlqERYVHWfaCJ3IlfZ00bNad2IA",
            authDomain: "eyeon-clinic-notice.firebaseapp.com",
            projectId: "eyeon-clinic-notice",
            storageBucket: "eyeon-clinic-notice.firebasestorage.app",
            messagingSenderId: "367090029799",
            appId: "1:367090029799:web:19e3cc50081f778e59fe42",
            measurementId: "G-6JCD02NTZW"
        };

        // Firebase 초기화
        let app, db, auth, storage;
        try {
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            storage = getStorage(app);
        } catch (e) {
            console.error("Firebase 초기화에 실패했습니다. firebaseConfig를 확인해주세요.", e);
            document.getElementById('notice-container').innerHTML = `<p class="text-center text-red-500">게시판을 불러오는 데 실패했습니다. 관리자에게 문의하세요.</p>`;
        }
        
        // DOM 요소
        const noticeContainer = document.getElementById('notice-container');
        const writeModal = document.getElementById('write-modal');
        const loginModal = document.getElementById('login-modal');
        const uploadProgressModal = document.getElementById('upload-progress-modal');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const imageUploadInput = document.getElementById('image-upload-input');
        const cancelUploadBtn = document.getElementById('cancel-upload-btn');
        const hyperlinkModal = document.getElementById('hyperlink-modal');
        const hyperlinkUrlInput = document.getElementById('hyperlink-url');
        const submitHyperlinkBtn = document.getElementById('submit-hyperlink');
        const cancelHyperlinkBtn = document.getElementById('cancel-hyperlink');
        
        // 상태 변수
        let simplemde;
        let currentPostId = null;
        let isAdmin = false;
        let currentUploadTask = null; // 업로드 작업을 추적하기 위한 변수

        // --- UI 렌더링 함수 ---
        
        // 게시물 목록 뷰 렌더링
        const renderListView = async () => {
            window.location.hash = '';
            noticeContainer.innerHTML = `
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-2xl font-bold text-deep-navy">All Notices</h2>
                    <div id="admin-controls"></div>
                </div>
                <div id="post-list" class="space-y-4">
                    <div class="loader"></div>
                </div>
            `;
            renderAdminControls();

            const postList = document.getElementById('post-list');
            try {
                const q = query(collection(db, "notices"), orderBy("createdAt", "desc"));
                const querySnapshot = await getDocs(q);
                
                if (querySnapshot.empty) {
                    postList.innerHTML = '<p class="text-center text-gray-500 py-10">게시물이 없습니다.</p>';
                    return;
                }
                
                postList.innerHTML = '';
                querySnapshot.forEach((doc) => {
                    const post = doc.data();
                    const postEl = document.createElement('a');
                    postEl.href = `#${doc.id}`;
                    postEl.className = "block bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300";
                    postEl.innerHTML = `
                        <div class="flex justify-between items-baseline">
                            <h3 class="text-xl font-bold text-deep-navy">${post.title}</h3>
                            <span class="text-sm text-gray-500">${post.createdAt ? new Date(post.createdAt.toDate()).toLocaleDateString() : '날짜 없음'}</span>
                        </div>
                    `;
                    postList.appendChild(postEl);
                });
            } catch (error) {
                console.error("공지사항 로딩 실패:", error);
                postList.innerHTML = '<p class="text-center text-red-500 py-10">게시물을 불러오는 데 실패했습니다.</p>';
            }
        };

        // 게시물 상세 뷰 렌더링
        const renderDetailView = async (postId) => {
            noticeContainer.innerHTML = `<div class="loader"></div>`;
            try {
                const docRef = doc(db, "notices", postId);
                const docSnap = await getDoc(docRef);

                if (docSnap.exists()) {
                    const post = docSnap.data();
                    const markedOptions = { breaks: true, gfm: true };
                    noticeContainer.innerHTML = `
                        <div class="max-w-4xl mx-auto bg-white p-8 md:p-12 rounded-2xl shadow-lg">
                            <div class="mb-8 text-center border-b pb-8">
                                <h1 class="text-3xl md:text-4xl font-bold text-deep-navy">${post.title}</h1>
                                <p class="mt-4 text-gray-500"><i class="fas fa-calendar-alt mr-2 text-emerald-teal"></i>${post.createdAt ? new Date(post.createdAt.toDate()).toLocaleString() : '날짜 없음'}</p>
                            </div>
                            <div class="post-content">${marked.parse(post.content || '', markedOptions)}</div>
                            <div class="flex justify-between items-center mt-12 border-t pt-6">
                                <a href="#" id="back-to-list" class="text-emerald-teal hover:underline font-semibold"><i class="fas fa-arrow-left mr-2"></i>목록으로</a>
                                <div id="detail-admin-controls" class="space-x-2"></div>
                            </div>
                        </div>
                    `;
                    document.getElementById('back-to-list').addEventListener('click', (e) => {
                        e.preventDefault();
                        renderListView();
                    });
                    renderAdminControls(postId, post.title, post.content);
                } else {
                    renderListView();
                }
            } catch (error) {
                console.error("게시물 상세 로딩 실패:", error);
                noticeContainer.innerHTML = '<p class="text-center text-red-500 py-10">게시물을 불러오는 데 실패했습니다.</p>';
            }
        };
        
        // 관리자 컨트롤 버튼 렌더링
        const renderAdminControls = (postId, title, content) => {
            const controlsContainer = postId ? document.getElementById('detail-admin-controls') : document.getElementById('admin-controls');
            if (!controlsContainer) return;
            
            if (isAdmin) {
                if(postId) { // 상세 뷰
                    controlsContainer.innerHTML = `
                        <button id="edit-post-btn" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 text-sm">수정</button>
                        <button id="delete-post-btn" class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 text-sm">삭제</button>
                    `;
                    document.getElementById('edit-post-btn').addEventListener('click', () => openWriteModal(postId, title, content));
                    document.getElementById('delete-post-btn').addEventListener('click', () => deletePost(postId));
                } else { // 목록 뷰
                    controlsContainer.innerHTML = `
                        <button id="write-new-post-btn" class="bg-emerald-teal text-white text-sm font-semibold px-5 py-2.5 rounded-full hover:opacity-90 transition-opacity"><i class="fas fa-pen-nib mr-2"></i>글쓰기</button>
                        <button id="logout-btn" class="ml-2 bg-gray-600 text-white text-sm font-semibold px-5 py-2.5 rounded-full hover:opacity-90 transition-opacity"><i class="fas fa-sign-out-alt mr-2"></i>로그아웃</button>
                    `;
                    document.getElementById('write-new-post-btn').addEventListener('click', () => openWriteModal());
                    document.getElementById('logout-btn').addEventListener('click', handleLogout);
                }
            } else { // 관리자가 아닐 때
                controlsContainer.innerHTML = `<button id="login-btn" class="bg-emerald-teal text-white text-sm font-semibold px-5 py-2.5 rounded-full hover:opacity-90 transition-opacity"><i class="fas fa-user-shield mr-2"></i>관리자 로그인</button>`;
                document.getElementById('login-btn').addEventListener('click', () => loginModal.classList.add('active'));
            }
        };

        // --- 모달 및 편집기 관련 함수 ---

        // 글쓰기/수정 모달 열기
        const openWriteModal = (postId = null, title = '', content = '') => {
            // 새 글 작성 시 필드 초기화
            const initialTitle = postId ? title : '';
            const initialContent = postId ? content : '';

            currentPostId = postId;
            document.getElementById('modal-title').textContent = postId ? '글 수정' : '새 글 작성';
            document.getElementById('post-title').value = initialTitle;
            
            if (simplemde) {
                simplemde.toTextArea();
                simplemde = null;
            }

            simplemde = new SimpleMDE({ 
                element: document.getElementById("post-content"),
                initialValue: initialContent,
                spellChecker: false,
                status: false,
                toolbar: [
                    "bold", "italic", "heading", "|", 
                    "quote", "unordered-list", "ordered-list", "|",
                    {
                        name: "link",
                        action: () => openHyperlinkModal(),
                        className: "fa fa-link",
                        title: "Insert Link",
                    },
                    "image", 
                    {
                        name: "upload-image",
                        action: () => imageUploadInput.click(),
                        className: "fa fa-upload",
                        title: "Upload Image",
                    },
                    "|", "table", "horizontal-rule", "|",
                    "preview", "side-by-side", "fullscreen"
                ],
            });
            
            writeModal.classList.add('active');
        };
        
        const closeWriteModal = () => writeModal.classList.remove('active');
        const closeLoginModal = () => loginModal.classList.remove('active');
        const closeHyperlinkModal = () => hyperlinkModal.classList.remove('active');

        // 하이퍼링크 모달 열기
        const openHyperlinkModal = () => {
            hyperlinkUrlInput.value = 'https://';
            hyperlinkModal.classList.add('active');
            hyperlinkUrlInput.focus();
        };

        // --- 데이터 처리 함수 (CRUD 및 이미지 업로드) ---

        // 이미지 업로드 처리
        const handleImageUpload = (event) => {
            const file = event.target.files[0];
            if (!file) return;

            // 2MB 용량 제한 체크
            if (file.size > 2 * 1024 * 1024) {
                alert('이미지 파일은 2MB를 초과할 수 없습니다.');
                event.target.value = '';
                return;
            }

            uploadProgressModal.classList.add('active');
            progressBar.style.width = '0%';
            progressText.textContent = '0%';

            const storageRef = ref(storage, `notices/${Date.now()}_${file.name}`);
            currentUploadTask = uploadBytesResumable(storageRef, file);

            currentUploadTask.on('state_changed', 
                (snapshot) => {
                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    progressBar.style.width = progress + '%';
                    progressText.textContent = Math.round(progress) + '%';
                }, 
                (error) => {
                    currentUploadTask = null;
                    uploadProgressModal.classList.remove('active');
                    if (error.code === 'storage/unauthorized') {
                        alert('이미지 업로드 권한이 없습니다. Firebase Storage 보안 규칙을 확인해주세요.');
                    } else if (error.code !== 'storage/canceled') {
                         alert('이미지 업로드에 실패했습니다.');
                    }
                    console.error("Upload failed", error);
                }, 
                () => {
                    currentUploadTask = null;
                    getDownloadURL(currentUploadTask.snapshot.ref).then((downloadURL) => {
                        const cm = simplemde.codemirror;
                        const doc = cm.getDoc();
                        const cursor = doc.getCursor();
                        const imageMarkdown = `\n![${file.name}](${downloadURL})\n`;
                        doc.replaceRange(imageMarkdown, cursor);
                        
                        setTimeout(() => {
                           uploadProgressModal.classList.remove('active');
                        }, 500);
                    });
                }
            );
            event.target.value = '';
        };

        // 게시물 저장/수정
        const handleSavePost = async () => {
            const title = document.getElementById('post-title').value;
            const content = simplemde.value();
            if (!title.trim() || !content.trim()) {
                alert('제목과 내용을 모두 입력해주세요.');
                return;
            }

            try {
                if (currentPostId) { // 수정
                    const postRef = doc(db, "notices", currentPostId);
                    await updateDoc(postRef, { title, content });
                    await renderDetailView(currentPostId);
                } else { // 생성
                    await addDoc(collection(db, "notices"), {
                        title,
                        content,
                        createdAt: serverTimestamp()
                    });
                    await renderListView();
                }
                closeWriteModal();
            } catch (error) {
                console.error("저장 실패:", error);
                alert("게시물 저장에 실패했습니다.");
            }
        };

        // 게시물 삭제
        const deletePost = async (postId) => {
            if (confirm('정말로 이 글을 삭제하시겠습니까?')) {
                try {
                    await deleteDoc(doc(db, "notices", postId));
                    await renderListView();
                } catch (error) {
                    console.error("삭제 실패:", error);
                    alert("게시물 삭제에 실패했습니다.");
                }
            }
        };

        // --- 인증 관련 함수 ---

        // 로그인 처리
        const handleLogin = async () => {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorP = document.getElementById('login-error');
            errorP.textContent = '';

            try {
                await signInWithEmailAndPassword(auth, email, password);
                closeLoginModal();
            } catch (error) {
                errorP.textContent = '로그인 정보가 올바르지 않습니다.';
            }
        };
        
        // 로그아웃 처리
        const handleLogout = async () => {
            try {
                await signOut(auth);
            } catch (error) {
                console.error("로그아웃 실패:", error);
                alert("로그아웃에 실패했습니다.");
            }
        };

        // --- 라우팅 및 초기화 ---

        // 해시 변경 감지 및 렌더링
        const handleRouteChange = () => {
            const postId = window.location.hash.substring(1);
            if (postId) {
                renderDetailView(postId);
            } else {
                renderListView();
            }
        };
        
        // 이벤트 리스너 설정
        window.addEventListener('hashchange', handleRouteChange);
        
        // 인증 상태 변경 감지
        onAuthStateChanged(auth, (user) => {
            isAdmin = !!user;
            handleRouteChange(); // 인증 상태 변경 시 UI 다시 렌더링
        });
        
        // 모달 및 파일 업로드 이벤트 리스너
        document.getElementById('cancel-post').addEventListener('click', closeWriteModal);
        document.getElementById('save-post').addEventListener('click', handleSavePost);
        document.getElementById('cancel-login').addEventListener('click', closeLoginModal);
        document.getElementById('submit-login').addEventListener('click', handleLogin);
        imageUploadInput.addEventListener('change', handleImageUpload);
        cancelUploadBtn.addEventListener('click', () => {
            if (currentUploadTask) {
                currentUploadTask.cancel();
            }
            uploadProgressModal.classList.remove('active');
        });
        cancelHyperlinkBtn.addEventListener('click', closeHyperlinkModal);
        submitHyperlinkBtn.addEventListener('click', () => {
            const url = hyperlinkUrlInput.value;
            if (url && url !== 'https://') {
                const cm = simplemde.codemirror;
                const doc = cm.getDoc();
                const selection = doc.getSelection();
                const text = selection || '링크 텍스트';
                doc.replaceSelection(`[${text}](${url})`);
            }
            closeHyperlinkModal();
        });


        // 이메일과 비밀번호 필드에서 Enter 키 입력 시 로그인 처리
        document.getElementById('login-email').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') handleLogin();
        });
        document.getElementById('login-password').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') handleLogin();
        });

    </script>
    
    <!-- Custom JS -->
    <script src="assets/js/main.js"></script>
</body>
</html>
